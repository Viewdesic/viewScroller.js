/* 
 * =================================================
 * viewScroller
 * Version: 2.2
 * Copyright (c) 2016 Marcin Gierczak
 * http://www.viewdesic.com
 * =================================================
 */
!function(e){e.fn.viewScroller=function(i){"object"==typeof i&&(i=e.extend({animSpeedMainView:700,animSpeedSubView:700,animEffectMainView:"easeInOutCubic",animEffectSubView:"easeInOutCubic",animEffectMainViewCss3:"ease",animEffectSubViewCss3:"ease",useKeyboard:!0,useScrollbar:!1,changeWhenAnim:!0,loopMainViews:!1,loopSubViews:!1,fitToView:!0,timeToFit:1e3,fixedWidth:0,spaceMainBag:0,beforeChange:null,afterChange:null,beforeResize:null,afterResize:null,viewsHeight:[]},i)),e.fn.viewScroller.setAnimSpeedMainView=function(e){i.animSpeedMainView=parseInt(e,10)||700},e.fn.viewScroller.setAnimSpeedSubView=function(e){i.animSpeedSubView=parseInt(e,10)||700},e.fn.viewScroller.setAnimEffectMainView=function(e){i.animEffectMainView=e},e.fn.viewScroller.setAnimEffectSubView=function(e){i.animEffectSubView=e},e.fn.viewScroller.setAnimEffectMainViewCss3=function(e){i.animEffectMainViewCss3=e},e.fn.viewScroller.setAnimEffectSubViewCss3=function(e){i.animEffectSubViewCss3=e},e.fn.viewScroller.setUseKeyboard=function(e){i.useKeyboard=e},e.fn.viewScroller.setChangeWhenAnim=function(e){i.changeWhenAnim=e},e.fn.viewScroller.setLoopMainViews=function(e){i.loopMainViews=e},e.fn.viewScroller.setLoopSubViews=function(e){i.loopSubViews=e},e.fn.viewScroller.setFitToView=function(e){i.fitToView=e},e.fn.viewScroller.setTimeToFit=function(e){i.timeToFit=parseInt(e,10)||1e3},e.fn.viewScroller.setUseScrollbar=function(e){i.useScrollbar=e,Z(h[0],h[0].viewsData.views[0],!1,!1),O(),ve(!1,!1,!1)},e.fn.viewScroller.setFixedWidth=function(e){i.fixedWidth=parseInt(e,10)||0,Y(),K(),ve(!1,!0,!1)},e.fn.viewScroller.setSpaceMainBag=function(e){i.spaceMainBag=parseInt(e,10)||0,K(),ve(!1,!0,!1)},e.fn.viewScroller.showMainView=function(e){q("next"===e?u.NEXT:u.PREV)},e.fn.viewScroller.showSubView=function(e,i){Q(e,"next"===i?u.NEXT:u.PREV)},e.fn.viewScroller.showView=function(e){k(e,!1)},e.fn.viewScroller.getCurrentBagNbr=function(){return W()};var n=".mainbag",t=".subbag",a=".mainview",s=".subview",o=n+">"+a,r=t+">"+s,c=0,f=1,u={NEXT:1,PREV:-1},l=0,w=[],v=0,h=[],p=!1,d="",g=!1,m=e(window),b=e(document),V=m.height(),S=m.width(),E=!1,y=!1,D=Date.now(),x=!0;var T,M=new function(){var i={};return{get:function(n){return void 0===i[n]&&(i[n]=e(n)),i[n]}}},P=function(){return void 0!==window.orientation},C=function(e,i){var n="#"+i.attr("vs-anchor");return"#undefined"===n&&(n=""),e+n},N=function(i){var n,t=[],a=0;for(M.get(o).slice(i,i+1).find(M.get(r)).each(function(i){t.push(C(i,e(this)))}),n=t.length;a<n;)a++;return t},A=function(e){for(var i=0,n=h.length;i<n;i++)for(var t=0,a=h[i].viewsData.views.length;t<a;t++)if(h[i].viewsData.views[t].split("#")[1]===e)return i;return-1},W=function(){if(window.location.hash.indexOf("#")>-1){urlViewName=window.location.hash.replace("#","");var i=[],n="div[vs-anchor="+urlViewName+"], section[vs-anchor="+urlViewName+"], article[vs-anchor="+urlViewName+"]";return M.get(n).find(M.get(r)).each(function(n){i.push(e(this).attr("vs-anchor"))}),i.length>0?A(i[0]):0===i.length&&(M.get(n).parents(M.get(t)).each(function(n){i.push(e(this).attr("class"))}),i.length>0&&i[0].includes(t.replace(".","")))?A(urlViewName):-1}return 0},k=function(e,i){g=!0===i,window.location.hash=e},I=function(e,i,n){var t=new Me;return t.setBagObj(e,i,n),t},R=function(){var i,a=(i=[],M.get(o).each(function(n){i.push(C(n,e(this)))}),i);h.push(I(n,a,c)),function(e){for(var i=[],n="",a=0,s=0,o=e.length;a<o;)i=N(a),n=e[a].split("#")[1],i.length>0&&(h.push(I(t+"|"+s+"|"+n+"|"+a,i,f)),s++),a++}(a)},B=function(){var e,i;!1===g&&window.location.hash.indexOf("#")>-1&&(e=window.location.hash.replace("#",""),void 0!==(i=z(e))&&i.length>0&&Z(h[i[0]],i[1],!1,!1)),g=!1},z=function(e){for(var i,n,t=[],a=0,s=h.length;a<s;a++){i=h[a].viewsData.views,n=h[a].viewsData.bagType;for(var o=0,r=i.length;o<r;o++)if(i[o].indexOf("#")>-1&&i[o].split("#")[1]===e)return t.push(a,i[o],n),t}},O=function(){i.useScrollbar?(M.get("html").css("overflow-y","scroll"),M.get("body").css("overflow-y","")):(M.get("body").css("overflow-y","hidden"),M.get("html").css("overflow-y","hidden"))},X=function(e,i){return i?1:e},L=function(e){var i;e.viewsData.viewsPos.length=0,i=U();for(var n=0,t=e.viewsData.views.length;n<t;n++)e.viewsData.bagType===f?F(e,n):H(e,n,i)},F=function(e,t){var a=M.get(n).width();S=m.width(),a=0===i.fixedWidth?S-i.spaceMainBag:i.fixedWidth,e.viewsData.viewsPos.push(a*t)},H=function(e,n,t){V=m.height(),0===n?e.viewsData.viewsPos.push(0):n>0&&t&&i.viewsHeight.length>=n&&0!==i.viewsHeight[n-1]?e.viewsData.viewsPos.push(e.viewsData.viewsPos[n-1]+i.viewsHeight[n-1]):n>0&&e.viewsData.viewsPos.push(e.viewsData.viewsPos[n-1]+V)},K=function(){var o=M.get(n).width(),r=m.height();o=0===i.fixedWidth?m.width()-i.spaceMainBag:i.fixedWidth,M.get(n).css("width",o+"px"),M.get(a).css("height",r+"px"),U()&&j(r),M.get(s).css("width",o+"px"),M.get(t).each(function(i){e(this).css("width",o*e(this).find(s).length+"px")}),x&&M.get(n).css("height","auto")},j=function(e){var n;Array.prototype.forEach.call(i.viewsHeight,function(i,t){0===(n=parseInt(i,10))&&(n=e),t++,M.get(a+":nth-child("+t+")").css("height",n+"px")})},U=function(){return Array.prototype.forEach.call(i.viewsHeight,function(e){if(isNaN(e)||parseInt(e,10)<0)return!1}),!0},Y=function(){i.fixedWidth>0&&M.get(n).css({position:"absolute"})},Q=function(e,n){e>-1&&(i.changeWhenAnim||!i.changeWhenAnim&&!E)&&Z(h[e],"",!1,!1,n)},q=function(e){(i.changeWhenAnim||!i.changeWhenAnim&&!E)&&Z(h[0],"",!1,!1,e)},G=function(e,n,t,a,s){var o,r;"x"===a?(o=X(i.animSpeedMainView,t),e.css({"-webkit-transition":"all "+o+"ms "+i.animEffectSubViewCss3+" 0ms","-moz-transition":"all "+o+"ms "+i.animEffectSubViewCss3+" 0ms","-o-transition":"all "+o+"ms "+i.animEffectSubViewCss3+" 0ms",transition:"all "+o+"ms "+i.animEffectSubViewCss3+" 0ms","-webkit-transform":"translate3d("+n+"px,0,0)","-moz-transform":"translate3d("+n+"px,0,0)","-o-transform":"translate3d("+n+"px,0,0)",transform:"translate3d("+n+"px,0,0)"})):(r=X(i.animSpeedMainView,t),e.css({"-webkit-transition":"all "+r+"ms "+i.animEffectMainViewCss3+" 0ms","-moz-transition":"all "+r+"ms "+i.animEffectMainViewCss3+" 0ms","-o-transition":"all "+r+"ms "+i.animEffectMainViewCss3+" 0ms",transition:"all "+r+"ms "+i.animEffectMainViewCss3+" 0ms","-webkit-transform":"translate3d(0,"+n+"px,0)","-moz-transform":"translate3d(0,"+n+"px,0)","-o-transform":"translate3d(0,"+n+"px,0)",transform:"translate3d(0,"+n+"px,0)"})),e.one("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){"function"==typeof s&&s()})},J=function(e,n,t,a,s){"x"===a?e.stop().animate({scrollLeft:n},X(i.animSpeedSubView,t),i.animEffectSubView,function(){"function"==typeof s&&s()}):e.stop().animate({scrollTop:n},X(i.animSpeedMainView,t),i.animEffectMainView,function(){"function"==typeof s&&s()})},Z=function(e,a,s,o,r){var c,u,l,w,v,g,m,b,V,S,D;void 0!==r&&(a=e.viewsData.views[(V=e,S=r,D=V.viewsData.views.indexOf(V.viewsData.activeView)+S,(i.loopSubViews&&void 0===V.viewsData.views[D]&&V.viewsData.container.includes(t)||i.loopMainViews&&void 0===V.viewsData.views[D]&&V.viewsData.container.includes(n))&&(D=D<0?V.viewsData.views.length-1:0),D)]),e.viewsData.views.length>0&&void 0!==a&&(c=e.viewsData.views.indexOf(a),u=e.viewsData.viewsPos[c],l=e.viewsData.bagType,w=e.viewsData.container,v=0,(y||!1===p&&(void 0===s&&!1===o||e.viewsData.activeView!==a&&!1===s))&&ie(),w===n?d=a.split("#")[1]:y||(s||d===w.split("|")[2]||(p=!0,Z(h[0],w.split("|")[3]+"#"+w.split("|")[2],!1,!1)),d=w.split("|")[2]),s||y||window.location.hash!==a.split("#")[1]&&k(a.split("#")[1],!0),l===f?(g=w.split("|")[0],m=w.split("|")[1],w=M.get(g+"-"+m)):w=M.get(w),b=w,E=!0,l===f?x?G(b,-1*u,s,"x",function(){$(o,e,a)}):J(b.parent(),u,s,"x",function(){$(o,e,a)}):(o||fe(),(i.useScrollbar||o)&&x&&(b=M.get("html, body")),i.useScrollbar||!x?(oe(),J(b,u,s,"y",function(){$(o,e,a)})):(v=M.get("body").scrollTop(),G(b,-1*(u-=v),s,"y",function(){$(o,e,a)})),i.useScrollbar||ce()),y||(e.viewsData.activeView=a,p=!1))},$=function(e,n,t){ne(),(i.useScrollbar||e)&&(g=!1,we(),_(),ee(),le(),se()),E=!1,y=!1},_=function(){m.height()!==V&&(ve(!1,!1,!1),V=m.height())},ee=function(){if(h[0].viewsData.viewsPos.length>1&&P()&&m.height()!==Math.abs(h[0].viewsData.viewsPos[0]-h[0].viewsData.viewsPos[1])){K();for(var e=0,i=h.length;e<i;e++)L(h[e]),Z(h[e],h[e].viewsData.activeView,!0)}},ie=function(){var e=!1;if("function"==typeof i.beforeChange&&(e=i.beforeChange()),v++,e)return!1},ne=function(){v>0&&("function"==typeof i.afterChange&&i.afterChange(),v-=1)},te=function(n){var t,a,s;n.preventDefault(),s=e(this).attr("href").replace("#",""),a=z(s),t=window.location.hash.substr(1),a&&a.length>0&&(i.changeWhenAnim||!i.changeWhenAnim&&!E||s!==t)&&k(s)},ae=function(){m.on("hashchange",B)},se=function(){m.on("scroll",re)},oe=function(){m.off("scroll",re)},re=function(){var e,n,t;e=function(e){for(var i=m.scrollTop(),n=0,t=0,a=0,s=0,o=e.length;s<o;s++)(t=Math.abs(e[s]-i))<n&&(a=s),n=t;return a}(h[0].viewsData.viewsPos),clearTimeout(l),m.off("hashchange",B),window.location.hash!=="#"+h[0].viewsData.views[e].split("#")[1]&&(k(h[0].viewsData.views[e].split("#")[1],!1),h[0].viewsData.activeView=h[0].viewsData.views[e]),l=setTimeout(function(){ae()},10),Array.prototype.forEach.call(w,function(e){clearTimeout(e)}),t=m.scrollTop(),w.length=0,w.push(setTimeout(function(){i.fitToView&&(n=!0,Array.prototype.forEach.call(h[0].viewsData.viewsPos,function(e){e===t&&(n=!1)}),n&&(y=!0,Z(h[0],h[0].viewsData.activeView,!1,!1)))},i.timeToFit))},ce=function(){m.on("mousewheel",ue)},fe=function(){m.off("mousewheel",ue)},ue=function(e){var i=Date.now(),n=i-D;D=i,!e.ctrlKey&&n>50&&(e.deltaY<0?q(u.NEXT):q(u.PREV))},le=function(){m.on("resize",ve)},we=function(){m.off("resize",ve)},ve=function(e,n,t){if(!P()||n||P()&&(o=m.height(),r=m.width(),Math.abs(V-o)>100?(V=o,1):Math.abs(S-r)>100&&(S=r,1))){"function"==typeof i.beforeResize&&void 0===t&&i.beforeResize(),K();for(var a=0,s=h.length;a<s;a++)L(h[a]),Z(h[a],h[a].viewsData.activeView,!0);"function"==typeof i.afterResize&&void 0===t&&i.afterResize()}var o,r},he=function(e){var n,t=0,a=(n=e,window.event?n.keyCode:n.which?n.which:void 0);if(t=W(),i.useKeyboard)switch(a){case 33:case 38:i.useScrollbar||q(u.PREV);break;case 34:case 40:i.useScrollbar||q(u.NEXT);break;case 39:0===t&&(t=1),t>-1&&Q(t,u.NEXT);break;case 37:0===t&&(t=1),t>-1&&Q(t,u.PREV);break;case 36:i.useScrollbar||k(h[0].viewsData.views[0].split("#")[1]);break;case 35:i.useScrollbar||k(h[0].viewsData.views[h[0].viewsData.views.length-1].split("#")[1])}},pe=[],de=0,ge=0,me={x:null,y:null},be=function(e){window.PointerEvent&&e.addEventListener("pointermove",De,!1),T&&(e.addEventListener("touchstart",Ee,!1),e.addEventListener("touchmove",De,!1),e.addEventListener("touchend",ye,!1))},Ve=function(e){return Se(e),me.x+"|"+me.y},Se=function(e){var i;if(T){if(pe=e.touches){i=pe.length;for(var n=0;n<i;n++){var t=pe[n];me.x=xe(t),me.y=Te(t)}}}else me.x=xe(e),me.y=Te(e)},Ee=function(e){var i=Ve(e).split("|");de=parseInt(i[0],10),ge=parseInt(i[1],10)},ye=function(e){var n=Ve(e).split("|"),t=0,a=parseInt(n[0],10),s=parseInt(n[1],10),o=parseInt(de+10,10),r=parseInt(de-10,10),c=parseInt(ge+50,10),f=parseInt(ge-50,10);Math.abs(a-de)<Math.abs(s-ge)?s>c?i.useScrollbar||q(u.PREV):s<f&&(i.useScrollbar||q(u.NEXT)):(t=W())>-1&&(a>o?Q(t,u.PREV):a<r&&Q(t,u.NEXT))},De=function(e){i.useScrollbar||(e.preventDefault?e.preventDefault():e.returnValue=!1),Se(e)},xe=function(e){return e.clientX},Te=function(e){return e.clientY},Me=function(){var e={activeView:"",container:"",bagType:c,views:[],viewsPos:[]};return{setBagObj:function(i,n,t){e.container=i,e.views=n,e.bagType=t,e.activeView=e.views[0]},viewsData:e}};!function(){var a,s;T="ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0,Array.prototype.indexOf||(Array.prototype.indexOf=function(e,i){a=this.length;for(var n=i||0,t=a;n<t;n++)if(this[n]===e)return n;return-1}),String.prototype.includes||(String.prototype.includes=function(){"use strict";return-1!==String.prototype.indexOf.apply(this,arguments)}),0===i.fixedWidth?M.get(n).css("width",M.get(n).width()-i.spaceMainBag+"px"):M.get(n).css("width",i.fixedWidth+"px"),"transition"in(s=document.createElement("p").style)||"WebkitTransition"in s||"MozTransition"in s||"msTransition"in s||"OTransition"in s||(x=!1),M.get(t).each(function(i){e(this).addClass(t.replace(".","")+"-"+i)}),M.get(t).wrap('<div style="overflow: hidden; height: 100%; width: 100%;"></div>'),K(),O(),R();for(var o=0,r=h.length;o<r;o++)L(h[o]);ve(!1,!1,!1),i.useScrollbar||ce(),M.get(n).find(M.get(".vs-active")).each(function(i){0===i&&k(e(this).attr("vs-anchor"))}),B(),M.get(".vs-anchor").on("click",te),ae(),se(),le(),be(window),M.get(".vs-subview-prev").each(function(i){e(this).on("click",function(){currBagNbr=W(),currBagNbr>-1&&Q(currBagNbr,u.PREV)})}),M.get(".vs-subview-next").each(function(i){e(this).on("click",function(){currBagNbr=W(),currBagNbr>-1&&Q(currBagNbr,u.NEXT)})}),M.get(".vs-mainview-prev").each(function(i){e(this).on("click",function(){q(u.PREV)})}),M.get(".vs-mainview-next").each(function(i){e(this).on("click",function(){q(u.NEXT)})}),i.useKeyboard&&b.on("keydown",he),Y()}()}}(jQuery);
